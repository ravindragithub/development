<!--
 - Created by Jai Chaturvedi on 7/08/2017.
 -->

<aura:component description="AccountMap"
                implements="forceCommunity:availableForAllPageTypes"
                access="global">
    
    <aura:attribute name="partners" type="WhereToBuyController.AccountType[]"/>
    <aura:attribute name="productId" type="String" default="null"/>
    <aura:attribute name="searchOption" type="String" default="null"/>
    <aura:attribute name="stateCountry" type="String" default="null"/>
    <aura:attribute name="communityURL" type="String"/>
    <aura:attribute name="communityPrefix" type="String"/>
    <aura:attribute name="map" type="Object"/>
    <aura:attribute name="spinner" type="Boolean" default="false"/>
    <aura:attribute name="errorMessage" type="String"/>
    <aura:attribute name="mapwidth" type="String" default="width:62%;"/>
    
    <aura:handler event="c:UpdateWhereToBuyMap" action="{!c.accountsLoaded}"/>
    <aura:handler event="c:FocusAccountOnMap" action="{!c.accountSelected}"/>
    <!--
    <ltng:require styles="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css,
                          https://api.mapbox.com/mapbox-gl-js/v0.39.1/mapbox-gl.css,
                          https://s3.amazonaws.com/kvhtest2/leaflet-routing-machine.css"
                  scripts="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js,
                           https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.js,
                           https://api.mapbox.com/mapbox-gl-js/v0.39.1/mapbox-gl.js,
                           https://s3.amazonaws.com/kvhtest2/leaflet-routing-machine.js"
                  afterScriptsLoaded="{!c.jsLoaded}"/>-->
    
    <ltng:require styles="{!join(',',
                          $Resource.leaflet + '/leaflet.css',
                          $Resource.leaflet + '/leaflet-routing-machine.css',
                          $Resource.leaflet + '/mapbox-gl.css')}"
                  scripts="{!join(',',
                           $Resource.leaflet + '/jquery.js',
                           $Resource.leaflet + '/leaflet.js',
                           $Resource.leaflet + '/leaflet-routing-machine.js',
                           $Resource.leaflet + '/mapbox-gl.js',
                           $Resource.leaflet + '/geo.js')}"
                  afterScriptsLoaded="{!c.jsLoaded}"/>
    <div>
        <div id="weathermap">
        	<div id="map" style="width:72%;" ></div>
    	</div>
        <aura:if isTrue="{!v.spinner}">
            <lightning:spinner variant="brand"
                               size="large"
                               style="height:100vh"
                               alternativeText="Searching Partners"/>
        </aura:if>
    </div>
    <style>
        .number-icon {
        background-image: url("{! $Label.c.Community_URL + '/' + $Label.c.Community_Prefix +'/resource/LocationIcon'}");
        text-align:center;
        color:#ffffff;
        line-height: 31px;
        }
    </style>
</aura:component>